custombutton://%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%0D%0A%3Ccustombutton%20xmlns%3Acb%3D%22http%3A//xsms.nm.ru/custombuttons/%22%3E%0A%20%20%3Cname%3EInsert%20Text%3C/name%3E%0A%20%20%3Cimage%3E%3C%21%5BCDATA%5Bdata%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABKElEQVR42u2XywqCQBSGtbZB22hd9CrRi7SIokeJoEUruz1D9weILrSrRW6jghZBuSz7D86ADlompRBz4FNGxzOfMyMcVSXiUP9dwPS4ngMHcI1KoAIGQP+1QBYUQI21R+zN16AfhkASpMGGtTUmQQJ7YDgFmqb5Sfa3UVRprU/gwq7UQQeseJdfC1RxHNtmIHSBBo5dMItKgAbsgbk/AWvX5kHG5V4MgiVhgInCvmfwEPpTWwdTsPUrkAApdhYjDoGlIEDJ6HvegbvQn2bzBs6K7034LsQlstZYsyf0CP6cFJACUkAKSAEpIAW+LkAJW4pV5foRIOE2WAQTcFZMlJQqniE7vxpYjMB/RvaKiVc8R2B8KFDm4mH8GYk1Jq8VQxFwqzEdM/cE0JfaIQhEsm4AAAAASUVORK5CYII%3D%5D%5D%3E%3C/image%3E%0A%20%20%3Cmode%3E0%3C/mode%3E%0A%20%20%3Cinitcode%3E%3C%21%5BCDATA%5Bconst%20cssHelp%20%3D%20encodeURIComponent%28this.Help%29%2C%0A%20%20%20%20%20%20ios%20%3D%20Components.classes%5B%22@mozilla.org/network/io-service%3B1%22%5D.getService%28Components.interfaces.nsIIOService%29%2C%0A%20%20%20%20%20%20sss%20%3D%20Components.classes%5B%22@mozilla.org/content/style-sheet-service%3B1%22%5D.getService%28Components.interfaces.nsIStyleSheetService%29%2C%0A%20%20%20%20%20%20mrw%20%3D%20Services.wm.getMostRecentWindow%28%22navigator%3Abrowser%22%29%2C%20num%20%3D%20this.id.match%28/%5Cd+/%29%2C%20popID%20%3D%20%22insert-text-popup%22%3B%0A%0Apref.root%20%3D%20%22extensions.custombuttons.insert_text%22%20+%20num%20+%20%22.%22%3B%0Apref.defaults%20%3D%20%7B%20list%3A%20%22%22%2C%20separator%3A%20%22%3C%3E%22%2C%20break%3A%20%22%3Cbr%3E%22%2C%20site%3A%20%22%22%20%7D%0A%0Afor%20%28var%20key%20in%20pref.defaults%29%20%7B%0A%20%20if%20%28pref.defaults.hasOwnProperty%28key%29%29%20%7B%0A%20%20%20%20var%20val%20%3D%20pref.defaults%5Bkey%5D%3B%0A%20%20%20%20switch%20%28typeof%20val%29%20%7B%0A%20%20%20%20%20%20case%20%22boolean%22%3A%0A%20%20%20%20%20%20%20%20Services.prefs.getDefaultBranch%28pref.root%29.setBoolPref%28key%2C%20val%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22number%22%3A%0A%20%20%20%20%20%20%20%20Services.prefs.getDefaultBranch%28pref.root%29.setIntPref%28key%2C%20val%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22string%22%3A%0A%20%20%20%20%20%20%20%20var%20str%20%3D%20Cc%5B%22@mozilla.org/supports-string%3B1%22%5D.createInstance%28Ci.nsISupportsString%29%3B%0A%20%20%20%20%20%20%20%20str.data%20%3D%20val%3B%0A%20%20%20%20%20%20%20%20Services.prefs.getDefaultBranch%28pref.root%29.setComplexValue%28%28key%29%2C%20Ci.nsISupportsString%2C%20str%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%7D%20%7D%20%7D%0A%0Afunction%20pref%28key%29%20%7B%0A%20%20var%20%7Bbranch%2C%20defaults%7D%20%3D%20pref%3B%0A%20%20if%20%28branch%20%3D%3D%20null%29%20branch%20%3D%20Services.prefs.getBranch%28pref.root%29%3B%0A%20%20switch%20%28typeof%20defaults%5Bkey%5D%29%20%7B%0A%20%20%20%20case%20%22boolean%22%3A%20return%20branch.getBoolPref%28key%29%3B%0A%20%20%20%20case%20%22number%22%3A%20return%20branch.getIntPref%28key%29%3B%0A%20%20%20%20case%20%22string%22%3A%20return%20branch.getComplexValue%28key%2C%20Ci.nsISupportsString%29.data%3B%0A%20%20%7D%0A%20%20return%20null%3B%0A%7D%0A%0Afunction%20gCV%28aKey%2C%20aBranch%29%20%7B%0A%20%20return%20Services.prefs.getComplexValue%28aBranch%20%3F%20pref.root%20+%20aKey%20%3A%20aKey%2C%20Ci.nsISupportsString%29.data%3B%0A%7D%0A%0Afunction%20sCV%28aKey%2C%20aVal%2C%20aBranch%29%20%7B%0A%20%20var%20str%20%3D%20Cc%5B%22@mozilla.org/supports-string%3B1%22%5D.createInstance%28Ci.nsISupportsString%29%3B%0A%20%20str.data%20%3D%20aVal%3B%0A%20%20Services.prefs.setComplexValue%28aBranch%20%3F%20pref.root%20+%20aKey%20%3A%20aKey%2C%20Ci.nsISupportsString%2C%20str%29%3B%0A%7D%0A%0Afunction%20getSS%28filepath%29%20%7B%20return%20ios.newURI%28%22data%3Atext/css%2C%22%20+%20filepath%2C%20null%2C%20null%29%20%7D%0A%0Afunction%20loadSheet%28filepath%29%20%7B%20sss.loadAndRegisterSheet%28getSS%28filepath%29%2C%20sss.USER_SHEET%29%20%7D%0A%0Afunction%20insertText%28e%29%20%7B%0A%20%20var%20tb%20%3D%20mrw.content.document.activeElement%3B%0A%20%20var%20text%2C%20posSel%2C%20br%20%3D%20new%20RegExp%28pref%28%22break%22%29%2C%20%22g%22%29%3B%0A%20%20if%20%28e%20%3D%3D%3D%20%22undo%22%29%20%7B%0A%20%20%20%20if%20%28list.length%20%3C%202%29%20text%20%3D%20pref%28%22list%22%29%3B%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20goDoCommand%28%22cmd_undo%22%29%3B%0A%20%20%20%20%20%20tb.focus%28%29%3B%0A%20%20%20%20%20%20tb.setSelectionRange%28tb.selectionEnd%2C%20tb.selectionEnd%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20tb.value%20%3D%20tb.value.replace%28text%2C%20%22%22%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28list.length%20%3C%202%29%20text%20%3D%20e%3B%0A%20%20%20%20else%20text%20%3D%20e.replace%28br%2C%20%22%5Cn%22%29%3B%0A%20%20%20%20var%20s1%20%3D%20tb.value.substr%280%2C%20tb.selectionStart%29%2C%20s2%20%3D%20tb.value.substr%28tb.selectionEnd%29%3B%0A%20%20%20%20tb.value%20%3D%20s1%20+%20text%20+%20s2%3B%0A%20%20%20%20posSel%20%3D%20s1.length%20+%20text.length%3B%0A%20%20%20%20tb.focus%28%29%3B%0A%20%20%20%20tb.setSelectionRange%28posSel%2C%20posSel%29%3B%0A%7D%20%7D%0A%0A//var%20gRoot%20%3D%20Services.prefs.getBranch%28pref.root%29%3B%0Avar%20msg%20%3D%20%22Insert/Remove%20Text%5Cn%20%20%20%5Cu2022%20Separate%20multiple%20entries%20with%20%22%20+%20pref%28%22separator%22%29%20+%20%22%5Cn%20%20%20%5Cu2022%20Browser%20restart%20on%20change%22%3B%0Avar%20list%20%3D%20pref%28%22list%22%29.split%28pref%28%22separator%22%29%29%2C%20pop%20%3D%20document.createElement%28%22menupopup%22%29%3B%0Avar%20tt%20%3D%20%22%5Cn%5C%0A%20%20%5Cu2022%20Shift%20+%20left-click%20%20%3E%20%201.%20%20%22%20+%20list%5B0%5D%20+%20%22%5Cn%5C%0A%20%20%5Cu2022%20Ctrl%20+%20left-click%20%20%3E%20%202.%20%20%22%20+%20list%5B1%5D%20+%20%22%5Cn%5C%0A%20%20%5Cu2022%20Alt%20+%20left-click%20%20%3E%20%203.%20%20%22%20+%20list%5B2%5D%20+%20%22%5Cn%5C%0A%20%20%5Cu2022%20Ctrl%20+%20Alt%20+%20left-click%20%20%3E%20%20Undo/Clear%20entry%5Cn%5C%0A%20%20%5Cu2022%20Middle-click%20%20%3E%20%20Settings%5Cn%5C%0A%20%20%5Cu2022%20Shift%20+%20Ctrl%20+%20left-click%20%3E%20Settings%22%3B%0A%0Aif%20%28list.length%20%3C%202%29%20this.type%20%3D%20%22button%22%3B%0Aelse%20%7B%0A%20%20//for%20each%20%28var%20x%20in%20list%29%20%7B%20***%20Deprecated%0A%20%20for%20%28var%20x%20of%20list%29%20%7B%0A%20%20%20%20var%20item%20%3D%20document.createElement%28%22menuitem%22%29%3B%0A%20%20%20%20item.setAttribute%28%22label%22%2C%20x%29%3B%0A%20%20%20%20item.setAttribute%28%22class%22%2C%20%22menuitem-iconic%22%29%3B%0A%20%20%20%20item.onclick%20%3D%20function%28e%29%20%7B%20insertText%28e.target.label%29%3B%20e.stopPropagation%28%29%20%7D%0A%20%20%20%20pop.appendChild%28item%29%3B%0A%20%20%7D%0A%20%20pop.id%20%3D%20popID%3B%0A%20%20this.type%20%3D%20%22menu-button%22%3B%0A%20%20this.appendChild%28pop%29%3B%0A%7D%0A%0Athis.onclick%20%3D%20function%28e%29%20%7B%0A%20%20var%20tb%20%3D%20mrw.content.document.activeElement%3B%0A%20%20if%20%28pref%28%22list%22%29%29%20%7B%0A%20%20%20%20if%20%28e.button%20%3D%3D%3D%200%20%26%26%20%21e.ctrlKey%20%26%26%20%21e.altKey%20%26%26%20%21e.shiftKey%29%20%7B%0A%20%20%20%20%20%20if%20%28tb.baseURI.match%28pref%28%22site%22%29%29%29%20%7B%0A%20%20%20%20%20%20%20%20var%20box%20%3D%20mrw.content.document.getElementById%28%22logonbox%22%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20doc%20%3D%20box.contentDocument%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20inp%20%3D%20doc.getElementById%28%22password-input-field%22%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20btn%20%3D%20doc.getElementById%28%22signin-button%22%29%3B%0A%20%20%20%20%20%20%20%20if%20%28inp.value%20%3D%3D%3D%20%22%22%20%7C%7C%20inp.value%20%21%3D%3D%20%22AJR_4uic%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20insertText%28pref%28%22list%22%29.split%28%22%3C%3E%22%29%5B0%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20btn.focus%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20btn.click%28%29%3B%0A%20%20%20%20%20%20%7D%20%7D%0A%20%20%20%20%7D%20else%20if%20%28list.length%20%3C%202%29%20%7B%0A%20%20%20%20%20%20insertText%28pref%28%22list%22%29%29%3B%0A%20%20%20%20%7D%20else%20if%20%28e.button%20%3D%3D%3D%200%20%26%26%20e.shiftKey%20%26%26%20%21e.ctrlKey%20%26%26%20%21e.altKey%29%20%7B%0A%20%20%20%20%20%20%20insertText%28list%5B0%5D%29%3B%0A%20%20%20%20%7D%20else%20if%20%28e.button%20%3D%3D%3D%200%20%26%26%20e.ctrlKey%20%26%26%20%21e.altKey%20%26%26%20%21e.shiftKey%29%20%7B%20%0A%20%20%20%20%20%20%20insertText%28list%5B1%5D%29%3B%0A%20%20%20%20%7D%20else%20if%20%28e.button%20%3D%3D%3D%200%20%26%26%20e.altKey%20%26%26%20%21e.ctrlKey%20%26%26%20%21e.shiftKey%29%20%7B%20%0A%20%20%20%20%20%20%20insertText%28list%5B2%5D%29%3B%0A%20%20%20%20%7D%20else%20if%20%28e.button%20%3D%3D%3D%200%20%26%26%20e.ctrlKey%20%26%26%20e.altKey%20%26%26%20%21e.shiftKey%29%20%7B%0A%20%20%20%20%20%20if%20%28tb.nodeName%20%3D%3D%3D%20%22INPUT%22%29%20tb.value%20%3D%20%22%22%3B%0A%20%20%20%20%20%20else%20insertText%28%22undo%22%29%3B%0A%20%20%20%20%20%20//pop.hidePopup%28%29%3B%0A%20%20%20%20%20%20pop.close%28%29%3B%0A%20%20%20%20%7D%20else%20if%20%28e.button%20%3D%3D%3D%200%20%26%26%20e.shiftKey%20%26%26%20e.ctrlKey%20%26%26%20%21e.altKey%20%7C%7C%20e.button%20%3D%3D%3D%201%20%7C%7C%20%21pref%28%22list%22%29%29%20%7B%0A%20%20%20%20%20%20var%20aId%20%3D%20prompt%28msg%2C%20pref%28%22list%22%29%29%3B%0A%20%20%20%20%20%20if%20%28aId%20%21%3D%3D%20pref%28%22list%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20sCV%28%22list%22%2C%20aId%2C%20true%29%3B%20//gRoot.setCharPref%28%22list%22%2C%20aId%29%3B%0A%20%20%20%20%20%20%20%20this.onRestart%28%29%3B%0A%20%20%20%20%20%20%7D%20%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20var%20aId%20%3D%20prompt%28msg%2C%20pref%28%22list%22%29%29%3B%0A%20%20%20%20if%20%28aId%20%21%3D%3D%20pref%28%22list%22%29%29%20%7B%0A%20%20%20%20%20%20sCV%28%22list%22%2C%20aId%2C%20true%29%3B%20//gRoot.setCharPref%28%22list%22%2C%20aId%29%3B%0A%20%20%20%20%20%20this.onRestart%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%0Athis.onRestart%20%3D%20function%28%29%20%7B%0A%20%20let%20cancelQuit%20%3D%20Cc%5B%27@mozilla.org/supports-PRBool%3B1%27%5D.createInstance%28Ci.nsISupportsPRBool%29%3B%0A%20%20Services.obs.notifyObservers%28cancelQuit%2C%20%27quit-application-requested%27%2C%20%27restart%27%29%3B%0A%20%20if%20%28cancelQuit.data%29%20return%3B%0A%20%20let%20appStartup%20%3D%20Cc%5B%27@mozilla.org/toolkit/app-startup%3B1%27%5D.getService%28Ci.nsIAppStartup%29%3B%0A%20%20appStartup.quit%28Ci.nsIAppStartup.eAttemptQuit%20%7C%20Ci.nsIAppStartup.eRestart%29%3B%0A%7D%0A%0Aif%20%28list.length%20%3C%202%29%20this.tooltipText%20%3D%20this.label%20+%20%22%20%3E%20%22%20+%20pref%28%22list%22%29%3B%0Aelse%20this.tooltipText%20%3D%20this.label%20+%20tt%3B%0AloadSheet%28cssHelp%29%3B%5D%5D%3E%3C/initcode%3E%0A%20%20%3Ccode%3E%3C%21%5BCDATA%5B/*CODE*/%5D%5D%3E%3C/code%3E%0A%20%20%3Caccelkey%3E%3C%21%5BCDATA%5B%5D%5D%3E%3C/accelkey%3E%0A%20%20%3Chelp%3E%3C%21%5BCDATA%5B%23insert-text-popup%20%7B%0A%20%20-moz-appearance%3A%20none%20%21important%3B%0A%20%20counter-reset%3A%20section%20%21important%3B%0A%7D%0A%0A%23insert-text-popup%20%3E%20.menuitem-iconic%3A%3Abefore%20%7B%0A%20%20counter-increment%3A%20section%20%21important%3B%0A%20%20content%3A%20counter%28section%29%20%27.%20%27%20%21important%3B%0A%7D%0A%0A%23insert-text-popup%20%3E%20.menuitem-iconic%20%7B%0A%20%20-moz-appearance%3A%20none%20%21important%3B%0A%20%20color%3A%20%23000%20%21important%3B%0A%7D%0A%0A%23insert-text-popup%20%3E%20.menuitem-iconic%3Ahover%20%7B%0A%20%20background-color%3A%20%23444%20%21important%3B%0A%20%20color%3A%20%23FFF%20%21important%3B%0A%7D%0A%0A%23insert-text-popup%20%3E%20.menuitem-iconic%3Anth-child%28-n+9%29%20%7B%0A%20%20padding-left%3A%206px%20%21important%3B%0A%7D%0A%0A%23insert-text-popup%20%3E%20.menuitem-iconic%20%3E%20.menu-iconic-left%20%7B%0A%20%20display%3A%20none%20%21important%3B%0A%7D%5D%5D%3E%3C/help%3E%0A%20%20%3Cattributes/%3E%0A%3C/custombutton%3E
